{% extends "recipes/layout.html" %} {% load static %}

<!-- prettier-ignore -->
{% block title %}{{ recipe.title }}{% endblock %}
<!-- prettier-ignore-end -->

{% block extra_css %}
<link href="{% static 'recipes/recipe_details.css' %}" rel="stylesheet" />
{% endblock %} {% block body %}
<div class="recipe-detail-container">
  {% if recipe.image %}
  <div class="image-container mb-3">
    <img
      src="{{ recipe.image.url }}"
      alt="{{ recipe.title }}"
      class="recipe-details-image"
    />
    {% endif %}
  </div>

  <div class="recipe-content">
    <h1 class="recipe-title">{{ recipe.title }}</h1>

    {% if shared_recipe %}
    <div class="recipe-meta">
      <span class="rating">⭐️⭐️⭐️⭐️⭐️ 45</span>
      <span class="author">{{ shared_recipe.author }}</span>
    </div>
    {% endif %}

    <div class="recipe-tags">
      {% for tag in tag_labels %}
      <span class="tag">{{ tag }}</span>
      {% endfor %}
    </div>

    <div class="recipe-sections">
      <div class="ingredients-section">
        <h2>Ingredients</h2>
        <ul class="ingredients-list">
          {% for ingredient in recipe.ingredients %}
          <li>
            <label><input type="checkbox" /> {{ ingredient }}</label>
          </li>
          {% endfor %}
        </ul>
      </div>

      <div class="instructions-section">
        <h2>Instructions</h2>
        <ol class="instructions-list">
          {% for instruction in recipe.instructions %}
          <li>{{ instruction }}</li>
          {% endfor %}
        </ol>
      </div>
    </div>

    <div class="button-group d-flex gap-2 justify-content-center">
      <a href="{% url 'saved' %}" class="btn view-btn">Back to Saved</a>
      <button class="btn view-btn">Edit</button>
      <button class="btn view-btn">Share</button>
      <form method="POST" action="{% url 'save_recipe' %}" class="save-recipe-form">
        {% csrf_token %}
        <input type="hidden" name="recipe_hash" value="{{ recipe.hash }}" />
        <button type="submit" class="btn remove-btn" data-saved="true">
          <span class="button-text">Remove</span>
          <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
        </button>
      </form>
    </div>
    <div class="saved-timestamp">
      Saved {{ saved_recipe.saved_at|date:"M d, Y" }}
    </div>
  </div>
</div>

<!-- Custom Confirmation Modal -->
<div id="remove-confirm-modal" class="custom-modal-backdrop d-none">
  <div class="custom-modal">
    <div class="custom-modal-content">
      <h5>Remove Recipe</h5>
      <p>Are you sure you want to remove this recipe from your saved recipes?</p>
      <div class="d-flex justify-content-end gap-2">
        <button id="cancel-remove-btn" class="btn btn-secondary">Cancel</button>
        <button id="confirm-remove-btn" class="btn btn-danger">Remove</button>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block script %}
<script type="module" src="{% static 'recipes/recipe_details.js' %}"></script>
{% endblock %}
