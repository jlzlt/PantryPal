{% extends "recipes/layout.html" %} {% load static %} {% block title %}Saved
Recipes{% endblock %} {% block body %} {% if saved_recipes %}
<div id="saved-recipe-results">
  <div class="accordion" id="savedRecipesAccordion">
    {% for recipe in saved_recipes %}
    <div class="accordion-item">
      <h2 class="accordion-header" id="heading{{ forloop.counter }}">
        <button
          class="accordion-button collapsed"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#collapse{{ forloop.counter }}"
          aria-expanded="false"
          aria-controls="collapse{{ forloop.counter }}"
        >
          <div class="d-flex align-items-center w-100">
            {% if recipe.image %}
            <div class="flex-shrink-0 me-3" style="width: 80px; height: 80px">
              <img
                src="{{ recipe.image.url }}"
                alt="{{ recipe.title }}"
                class="w-100 h-100 object-fit-cover rounded"
              />
            </div>
            {% else %}
            <div
              class="flex-shrink-0 me-3 d-flex align-items-center justify-content-center bg-light text-muted rounded"
              style="width: 80px; height: 80px"
            >
              <span>No Image</span>
            </div>
            {% endif %}
            <div class="flex-grow-1">
              <h5 class="mb-0">{{ recipe.title }}</h5>
            </div>
          </div>
        </button>
      </h2>
      <div
        id="collapse{{ forloop.counter }}"
        class="accordion-collapse collapse"
        aria-labelledby="heading{{ forloop.counter }}"
      >
        <div class="accordion-body">
          <div class="d-flex gap-4 flex-wrap mb-3">
            <div class="flex-fill" style="min-width: 200px">
              <strong>Ingredients:</strong>
              <ul class="mb-2">
                {% for ingredient in recipe.ingredients %}
                <li>{{ ingredient }}</li>
                {% endfor %}
              </ul>
            </div>

            <div class="flex-fill" style="min-width: 200px">
              <strong>Instructions:</strong>
              <ol class="mb-0">
                {% for step in recipe.instructions %}
                <li>{{ step }}</li>
                {% endfor %}
              </ol>
            </div>
          </div>
          {% if user.is_authenticated %}
          <form
            method="POST"
            action="{% url 'save_recipe' %}"
            enctype="multipart/form-data"
            class="mt-auto save-recipe-form"
          >
            {% csrf_token %}
            <input type="hidden" name="hash" value="{{ recipe.hash }}" />
            <input type="hidden" name="title" value="{{ recipe.title }}" />
            <input
              type="hidden"
              name="ingredients"
              value="{{ recipe.ingredients }}"
            />
            <input
              type="hidden"
              name="instructions"
              value="{{ recipe.instructions }}"
            />
            <input type="hidden" name="tags" value="{{ recipe.filters }}" />
            <input type="hidden" name="image_url" value="{{ recipe.image }}" />
            <button
              type="submit"
              class="btn btn-outline-success btn-sm w-100"
              data-saved="true"
              style="font-weight: 500"
            >
              <span class="button-text">Remove from Saved</span>
              <span
                class="spinner-border spinner-border-sm d-none"
                role="status"
                aria-hidden="true"
              ></span>
            </button>
          </form>
          {% endif %}
        </div>
      </div>
    </div>

    {% if recipe.image %}
    <!-- Image Modal -->
    <div
      class="modal fade"
      id="imageModal{{ forloop.counter }}"
      tabindex="-1"
      aria-labelledby="imageModalLabel{{ forloop.counter }}"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="imageModalLabel{{ forloop.counter }}">
              {{ recipe.title }}
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body p-0">
            <img
              src="{{ recipe.image.url }}"
              alt="{{ recipe.title }}"
              class="img-fluid w-100"
              style="max-height: 80vh; object-fit: contain;"
            />
          </div>
        </div>
      </div>
    </div>
    {% endif %}
    {% endfor %}
  </div>
</div>
{% else %}
<div class="text-center py-5">
  <h4 class="mb-3">You have not saved recipes yet.</h4>
</div>
{% endif %} {% endblock %} {% block script %}
<script type="module" src="{% static 'recipes/saved.js' %}"></script>
{% endblock %}
